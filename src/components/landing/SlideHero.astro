---
const banner = `┌──────────────────────────────────────────────────────────┐
│  ░██████╗░░██████╗░██╗░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░  │
│  ██╔════╝░██╔════╝░██║░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░  │
│  ╚█████╗░░╚█████╗░░██║░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░  │
│  ░╚═══██╗░░╚═══██╗░██║░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░  │
│  ██████╔╝░██████╔╝░███████╗░░░░░░░░░░░░░░░░░░░░░░░░░░░░  │
│  ╚═════╝░░╚═════╝░░╚══════╝░░░░░░░░░░░░░░░░░░░░░░░░░░░░  │
│  ████████╗░█████╗░░█████╗░██╗░░░░░██╗░██╗██╗████████╗░░  │
│  ╚══██╔══╝██╔══██╗██╔══██╗██║░░░░░██║██╔╝░██║╚══██╔══╝░  │
│  ░░░██║░░░██║░░██║██║░░██║██║░░░░░█████╔╝░██║░░░██║░░░░  │
│  ░░░██║░░░██║░░██║██║░░██║██║░░░░░██╔═██╗░██║░░░██║░░░░  │
│  ░░░██║░░░╚█████╔╝╚█████╔╝███████╗██║░╚██╗██║░░░██║░░░░  │
│  ░░░╚═╝░░░░╚════╝░░╚════╝░╚══════╝╚═╝░░╚═╝╚═╝░░░╚═╝░░░░  │
└──────────────────────────────────────────────────────────┘`;
---

<section id="slide-hero" class="slide min-h-[100dvh] flex items-center justify-center relative overflow-hidden">
  <!-- Background effects -->
  <div class="absolute inset-0 grid-bg opacity-20"></div>
  <div class="absolute top-1/4 left-1/2 -translate-x-1/2 w-[800px] h-[800px] rounded-full bg-tokyo-purple/8 blur-[150px]"></div>
  <div class="absolute bottom-0 right-0 w-[500px] h-[500px] rounded-full bg-tokyo-blue/6 blur-[120px]"></div>
  <div class="absolute top-0 left-0 w-[400px] h-[400px] rounded-full bg-tokyo-cyan/4 blur-[100px]"></div>

  <div class="relative w-full max-w-7xl mx-auto px-4 py-4 md:py-8">
    <div class="grid md:grid-cols-2 gap-4 md:gap-8 lg:gap-12 items-center">
      <!-- Left: Hero content -->
      <div class="text-center md:text-left slide-content">
        <!-- Logo + ASCII Banner -->
        <div class="flex flex-col md:flex-row items-center md:items-start gap-3 md:gap-5 slide-fade-up">
          <!-- Favicon/Logo -->
          <div class="shrink-0 relative group">
            <div class="absolute inset-0 bg-tokyo-purple/20 blur-xl rounded-full group-hover:bg-tokyo-purple/30 transition-colors"></div>
            <img 
              src="/favicon.svg" 
              alt="ssl-toolkit logo" 
              class="relative w-16 h-16 md:w-20 md:h-20 lg:w-24 lg:h-24 drop-shadow-lg hover:scale-105 transition-transform"
            />
          </div>
          <!-- ASCII Banner -->
          <div class="relative">
            <pre class="text-tokyo-purple font-mono text-[0.45rem] sm:text-[0.5rem] md:text-[0.55rem] lg:text-[0.65rem] leading-[1.1] banner-glow select-none whitespace-pre overflow-x-auto">{banner}</pre>
          </div>
        </div>

        <!-- Tagline -->
        <div class="slide-fade-up slide-delay-1">
          <p class="mt-4 md:mt-5 text-lg md:text-xl lg:text-2xl font-mono font-bold gradient-text">
            SSL/TLS Certificate Diagnostic Tool
          </p>
          <p class="mt-2 md:mt-3 text-xs md:text-sm lg:text-base text-tokyo-text-dim max-w-xl mx-auto md:mx-0 leading-relaxed">
            Comprehensive certificate analysis, security grading, and diagnostics from the command line. Written in Rust.
          </p>
        </div>

        <!-- Quick Install -->
        <div class="mt-4 md:mt-5 slide-fade-up slide-delay-1">
          <p class="text-[10px] md:text-xs text-tokyo-text-dim/70 font-mono mb-2 uppercase tracking-wider">Quick Install</p>
          <div class="inline-flex items-center gap-2 bg-tokyo-bg-dark/80 border border-tokyo-border/50 rounded-lg px-3 md:px-4 py-2 md:py-2.5 font-mono text-xs md:text-sm group hover:border-tokyo-green/50 transition-all">
            <span class="text-tokyo-green">$</span>
            <code class="text-tokyo-text">brew install russmckendrick/tap/ssl-toolkit</code>
            <button 
              id="copy-install" 
              class="ml-2 text-tokyo-text-dim hover:text-tokyo-cyan transition-colors" 
              title="Copy to clipboard"
              aria-label="Copy install command"
            >
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
              </svg>
            </button>
          </div>
        </div>

        <!-- CTA Buttons -->
        <div class="mt-4 md:mt-6 flex flex-row items-center md:items-start justify-center md:justify-start gap-2 md:gap-3 slide-fade-up slide-delay-2">
          <a
            href="/docs/"
            class="group flex items-center gap-1.5 md:gap-2 bg-tokyo-blue/10 border border-tokyo-blue/30 hover:border-tokyo-blue/60 rounded-lg px-3 md:px-5 py-2 md:py-2.5 font-mono text-xs md:text-sm text-tokyo-blue hover:bg-tokyo-blue/15 transition-all"
          >
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
            </svg>
            <span class="hidden xs:inline">Read the </span>Docs
            <svg class="w-3 h-3 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
            </svg>
          </a>

          <a
            href="https://github.com/russmckendrick/ssl-toolkit"
            target="_blank"
            rel="noopener noreferrer"
            class="group flex items-center gap-1.5 md:gap-2 bg-tokyo-bg-light/50 border border-tokyo-border rounded-lg px-3 md:px-4 py-2 md:py-2.5 font-mono text-xs md:text-sm text-tokyo-text-dim hover:text-tokyo-text hover:border-tokyo-blue/50 transition-all"
          >
            <svg class="w-4 h-4 group-hover:scale-110 transition-transform" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
            </svg>
            GitHub
          </a>
        </div>
      </div>

      <!-- Right: Terminal demo -->
      <div class="slide-fade-up slide-delay-2 md:slide-delay-1">
        <div class="terminal-window rounded-lg md:rounded-xl overflow-hidden relative crt-scan">
          <!-- Title Bar -->
          <div class="flex items-center gap-2 px-3 md:px-4 py-2 md:py-3 bg-tokyo-bg-dark/80 border-b border-tokyo-border/50">
            <div class="flex gap-1.5 md:gap-2">
              <div class="w-2.5 h-2.5 md:w-3 md:h-3 rounded-full bg-tokyo-red/80 hover:bg-tokyo-red transition-colors"></div>
              <div class="w-2.5 h-2.5 md:w-3 md:h-3 rounded-full bg-tokyo-orange/80 hover:bg-tokyo-orange transition-colors"></div>
              <div class="w-2.5 h-2.5 md:w-3 md:h-3 rounded-full bg-tokyo-green/80 hover:bg-tokyo-green transition-colors"></div>
            </div>
            <div class="flex-1 text-center">
              <span class="text-[9px] md:text-[11px] font-mono text-tokyo-text-dim/60">ssl-toolkit &mdash; bash &mdash; 80x24</span>
            </div>
            <div class="w-[40px] md:w-[52px]"></div>
          </div>

          <!-- Terminal Body -->
          <div class="bg-tokyo-bg-dark p-3 md:p-4 lg:p-5 font-mono text-[9px] md:text-[10px] lg:text-[11px] h-[200px] md:h-[300px] lg:h-[380px] overflow-y-auto relative scanlines leading-[1.4] md:leading-[1.5]" id="terminal-container">
            <div id="terminal-output"></div>
            <span id="terminal-cursor" class="cursor-blink text-tokyo-green inline">█</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Scroll indicator (hidden on mobile) -->
  <div class="hidden md:flex absolute bottom-8 left-1/2 -translate-x-1/2 flex-col items-center gap-2 text-tokyo-text-dim/50 animate-float">
    <span class="text-[10px] font-mono uppercase tracking-widest">Scroll</span>
    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"/>
    </svg>
  </div>
</section>

<script>
  // Terminal animation
  interface LinePart {
    text: string;
    cls?: string;
    typed?: boolean;
  }

  interface TableCell {
    text: string;
    cls?: string;
  }

  interface TableRow {
    cells: (string | TableCell)[];
  }

  interface TableData {
    headers: string[];
    rows: TableRow[];
  }

  interface GradeBox {
    grade: string;
    score: string;
  }

  interface Line {
    text?: string;
    cls?: string;
    pause?: number;
    parts?: LinePart[];
    clear?: boolean;
    table?: TableData;
    gradebox?: GradeBox;
  }

  interface Scenario {
    lines: Line[];
  }

  interface TerminalConfig {
    colorMap: Record<string, string>;
    scenarios: Scenario[];
  }

  const output = document.getElementById('terminal-output')!;
  const container = document.getElementById('terminal-container')!;
  let running = true;
  let colorMap: Record<string, string> = {};
  let scenarios: Scenario[] = [];

  function sleep(ms: number) { return new Promise(r => setTimeout(r, ms)); }

  function appendText(html: string) {
    output.insertAdjacentHTML('beforeend', html);
    container.scrollTop = container.scrollHeight;
  }

  function appendElement(html: string) {
    const div = document.createElement('div');
    div.innerHTML = html;
    output.appendChild(div.firstElementChild!);
    container.scrollTop = container.scrollHeight;
  }

  async function typeText(text: string, style: string) {
    for (const ch of text) {
      appendText(ch === ' ' ? ' ' : `<span style="${style}">${ch}</span>`);
      await sleep(30 + Math.random() * 20);
    }
  }

  function renderPart(part: LinePart): string {
    return `<span style="${colorMap[part.cls || ''] || ''}">${part.text}</span>`;
  }

  function renderTable(table: TableData): string {
    const dimColor = colorMap['dim'] || 'color: #565f89';
    const textColor = colorMap['text'] || 'color: #c0caf5';
    
    let html = `<table style="border-collapse: collapse; margin: 4px 0 8px 8px; font-size: inherit; ${dimColor}">`;
    
    // Header row
    html += '<thead><tr>';
    table.headers.forEach((header) => {
      html += `<th style="border: 1px solid #3b4261; padding: 2px 8px; text-align: left; font-weight: normal; ${dimColor}">${header}</th>`;
    });
    html += '</tr></thead>';
    
    // Data rows
    html += '<tbody>';
    table.rows.forEach((row) => {
      html += '<tr>';
      row.cells.forEach((cell) => {
        if (typeof cell === 'string') {
          html += `<td style="border: 1px solid #3b4261; padding: 2px 8px; ${dimColor}">${cell}</td>`;
        } else {
          const cellStyle = colorMap[cell.cls || ''] || textColor;
          html += `<td style="border: 1px solid #3b4261; padding: 2px 8px; ${cellStyle}">${cell.text}</td>`;
        }
      });
      html += '</tr>';
    });
    html += '</tbody></table>';
    
    return html;
  }

  function renderGradeBox(gradebox: GradeBox): string {
    const gradeColor = colorMap['grade'] || 'color: #9ece6a; font-weight: bold';
    const boxColor = colorMap['gradebox'] || 'color: #9ece6a';
    
    return `<table style="border-collapse: collapse; margin: 8px 0; font-size: inherit; ${boxColor}">
      <tr>
        <td style="padding: 0;">╔</td>
        <td style="padding: 0;">══════════════════════════</td>
        <td style="padding: 0;">╗</td>
      </tr>
      <tr>
        <td style="padding: 0;">║</td>
        <td style="padding: 0 8px; ${gradeColor}">Grade: ${gradebox.grade} &nbsp; Score: ${gradebox.score}</td>
        <td style="padding: 0;">║</td>
      </tr>
      <tr>
        <td style="padding: 0;">╚</td>
        <td style="padding: 0;">══════════════════════════</td>
        <td style="padding: 0;">╝</td>
      </tr>
    </table>`;
  }

  async function renderLine(line: Line): Promise<void> {
    if (line.clear) {
      output.innerHTML = '';
      return;
    }

    if (line.table) {
      appendElement(renderTable(line.table));
      return;
    }

    if (line.gradebox) {
      appendElement(renderGradeBox(line.gradebox));
      return;
    }

    if (line.parts) {
      for (const part of line.parts) {
        if (part.typed) {
          await typeText(part.text, colorMap[part.cls || ''] || '');
        } else {
          appendText(renderPart(part));
        }
      }
      appendText('\n');
      return;
    }

    if (line.text === '' || line.text === undefined) {
      appendText('\n');
      return;
    }

    appendText(`<span style="${colorMap[line.cls || ''] || ''}">${line.text}</span>\n`);
  }

  async function playScenario(scenario: Scenario) {
    for (const line of scenario.lines) {
      const pause = line.pause || 60;
      await sleep(pause);
      await renderLine(line);
    }
  }

  async function run() {
    try {
      const response = await fetch('/config/terminal-demo.json');
      const config: TerminalConfig = await response.json();
      colorMap = config.colorMap;
      scenarios = config.scenarios;
    } catch (error) {
      console.error('Failed to load terminal demo config:', error);
      return;
    }

    let idx = 0;
    while (running) {
      output.innerHTML = '';
      await sleep(400);
      await playScenario(scenarios[idx]);
      await sleep(4000);
      idx = (idx + 1) % scenarios.length;
    }
  }

  run();

  // Copy to clipboard functionality
  const copyBtn = document.getElementById('copy-install');
  if (copyBtn) {
    copyBtn.addEventListener('click', async () => {
      try {
        await navigator.clipboard.writeText('brew install russmckendrick/tap/ssl-toolkit');
        // Visual feedback
        const svg = copyBtn.querySelector('svg');
        if (svg) {
          svg.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>';
          copyBtn.classList.add('text-tokyo-green');
          setTimeout(() => {
            svg.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>';
            copyBtn.classList.remove('text-tokyo-green');
          }, 2000);
        }
      } catch (err) {
        console.error('Failed to copy:', err);
      }
    });
  }
</script>
